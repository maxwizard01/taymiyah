<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Number & Numeration Quiz</title>

<style>
body {
    font-family: Arial, sans-serif;
    background: linear-gradient(135deg,#283048,#859398);
    min-height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 20px;
}
.card {
    background: #fff;
    max-width: 750px;
    width: 100%;
    padding: 25px;
    border-radius: 16px;
    text-align: center;
}
select {
    padding: 8px;
    border-radius: 6px;
    margin-bottom: 10px;
}
.status {
    display: flex;
    justify-content: space-between;
    background: #f0f0f0;
    padding: 10px;
    border-radius: 10px;
    font-weight: bold;
    margin-bottom: 10px;
}
#question {
    font-size: 1.3rem;
    margin: 15px 0;
}
.options {
    display: grid;
    grid-template-columns: repeat(auto-fit,minmax(180px,1fr));
    gap: 10px;
}
button {
    padding: 12px;
    background: #283048;
    color: #fff;
    border: none;
    border-radius: 8px;
    cursor: pointer;
}
button:hover {
    background: #1b1f2b;
}
#feedback {
    margin-top: 10px;
    font-weight: bold;
}
.correct { color: green; }
.wrong { color: red; }
#steps {
    background: #f4f4f4;
    margin-top: 15px;
    padding: 10px;
    display: none;
    text-align: left;
}
</style>
</head>

<body>

<div class="card">
<h2>üìò Number & Numeration Quiz</h2>

<div class="status">
    <span>‚è± Time: <span id="time">20</span>s</span>
    <span>‚≠ê Score: <span id="score">0</span></span>
    <span>üèÜ High: <span id="high">0</span></span>
</div>

<select id="mode" onchange="generateQuestion()">
    <option value="0">All Patterns (Random)</option>
    <option value="1">H.C.F / L.C.M</option>
    <option value="2">Prime Factorization</option>
    <option value="3">Fraction ‚Üí Decimal / Percentage</option>
    <option value="4">Approximation</option>
</select>

<p id="question"></p>
<div class="options" id="options"></div>
<p id="feedback"></p>
<div id="steps"></div>
<audio id="correctSound" src="correct.mp3"></audio>
<audio id="gameOverSound" src="wrong.mp3"></audio>
</div>

<script>
const correctSound = document.getElementById("correctSound");
const gameOverSound = document.getElementById("gameOverSound");
let correctAnswer="";
let attempts=0, correct=0;
let lock=false;
let TotalScore=0 
let timeLeft = 20, timer;
let highScore = localStorage.getItem("numHighScore") || 0;

document.getElementById("high").textContent = highScore;
document.getElementById("score").textContent = correct;


function rand(min,max){ return Math.floor(Math.random()*(max-min+1))+min; }

function updateScore(){
    let percent = attempts ? Math.round(correct/attempts*100) : 0;
    document.getElementById("score").textContent =
        `Score: ${correct} / ${attempts} (${percent}%)`;
}

function gcd(a,b){ return b===0 ? a : gcd(b,a%b); }
function lcm(a,b){ return (a*b)/gcd(a,b); }

function generateQuestion(){
    lock=false;
    document.getElementById("feedback").textContent="";
    document.getElementById("steps").style.display="none";

    let mode = Number(document.getElementById("mode").value);
    if(mode===0) mode = rand(1,4);

    let q="", s="", a="", opts=new Set();

    /* ================= 1. HCF / LCM ================= */
    if(mode===1){
        let nums=[rand(6,24),rand(6,24),rand(6,24)];
        let list=Math.random()<0.5 ? nums.slice(0,2) : nums;

        if(Math.random()<0.5){
            q=`Find the H.C.F of ${list.join(", ")}`;
            a=list.reduce((x,y)=>gcd(x,y)).toString();
            let base=Number(a);
            opts=new Set([base,base+1,base-1,base+2].filter(x=>x>0).map(String));
            s=`Find common prime factors ‚Üí HCF = ${a}`;
        }else{
            q=`Find the L.C.M of ${list.join(", ")}`;
            a=list.reduce((x,y)=>lcm(x,y)).toString();
            let base=Number(a);
            opts=new Set([base,base/2,base*2,base+base/2].map(x=>Math.round(x)).map(String));
            s=`Use highest powers of primes ‚Üí LCM = ${a}`;
        }
    }

    /* ================= 2. PRIME FACTORIZATION ================= */
    if(mode===2){
        let n=rand(24,96);
        let temp=n, map={};

        for(let i=2;i<=temp;i++){
            while(temp%i===0){
                map[i]=(map[i]||0)+1;
                temp/=i;
            }
        }

        a=Object.keys(map)
          .map(p=>map[p]===1?p:`${p}<sup>${map[p]}</sup>`)
          .join(" √ó ");

        q=`Express ${n} as a product of its prime factors`;

        opts.add(a);
        while(opts.size<4){
            let fake=[];
            Object.keys(map).forEach(p=>{
                let power=Math.max(1,map[p]+[-1,0,1][rand(0,2)]);
                fake.push(power===1?p:`${p}<sup>${power}</sup>`);
            });
            opts.add(fake.join(" √ó "));
        }

        s=`Prime factorization of ${n}<br><b>Answer:</b> ${a}`;
    }

    /* ================= 3. FRACTION ================= */
    if(mode===3){
        let num=rand(1,9), den=rand(2,10);
        let value=num/den;

        if(Math.random()<0.5){
            q=`Convert ${num}/${den} to a decimal`;
            a=value.toFixed(2);
            opts=new Set([
                a,
                (Math.floor(value*100)/100).toFixed(2),
                (Math.ceil(value*100)/100).toFixed(2),
                value.toFixed(1)
            ]);
            s=`${num} √∑ ${den} = ${a}`;
        }else{
            q=`Convert ${num}/${den} to a percentage`;
            a=(value*100).toFixed(1)+"%";
            opts=new Set([
                a,
                (value*100).toFixed(0)+"%",
                (value*10).toFixed(1)+"%",
                (value*100).toFixed(2)+"%"
            ]);
            s=`(${num} √∑ ${den}) √ó 100% = ${a}`;
        }
    }

    /* ================= 4. APPROXIMATION ================= */
    if(mode===4){
        let n=(Math.random()*100).toFixed(4);
        let type=rand(1,3);

        if(type===1){
            q=`Round ${n} to 2 decimal places`;
            a=(Math.round(n*100)/100).toFixed(2);
        }
        if(type===2){
            q=`Round ${n} to 3 significant figures`;
            a=Number(n).toPrecision(3);
        }
        
        if(type===3){
            q=`Round ${n} to the nearest whole number`;
            a=Math.round(n).toString();
        }

        let base=Number(a);
        opts=new Set([
            a,
            (base+0.01).toFixed(2),
            (base-0.01).toFixed(2),
            Math.floor(Number(n)).toString()
        ]);

        s=`Apply rounding rule ‚Üí ${a}`;
    }

    correctAnswer=a;

    document.getElementById("question").innerHTML=q;
    document.getElementById("options").innerHTML=
        [...opts].sort(()=>Math.random()-0.5)
        .map(o=>`<button onclick="check('${o}',\`${s}\`)">${o}</button>`)
        .join("");
}

// ================= CHECK =================
function check(choice,steps){
    if(lock) return;
    lock=true;
    clearInterval(timer);

    attempts++;
    let f=document.getElementById("feedback");
    let st=document.getElementById("steps");

    if(choice===correctAnswer){
        correctSound.play()
        correct++;
        TotalScore++
        f.textContent="‚úÖ Correct!";
        f.className="correct";
    }else{
        gameOverSound.play()
        TotalScore++
        f.textContent="‚ùå Wrong";
        f.className="wrong";
    }

    document.getElementById("score").textContent=`${correct}/${TotalScore}`;

    if(correct>highScore){
        highScore=correct;
        localStorage.setItem("numHighScore",highScore);
        document.getElementById("high").textContent=highScore;
    }

    st.innerHTML=steps;
    st.style.display="block";

    setTimeout(generateQuestion,3000);
}

generateQuestion();
</script>

</body>
</html>
